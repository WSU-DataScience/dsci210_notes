<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>1.12. Excel: Merge Tables, i.e. MATCH() / INDEX() Functions &mdash; Runestone Interactive Overview</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.0.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/codemirror.css" type="text/css" />
    <link rel="stylesheet" href="_static/activecode.css" type="text/css" />
    <link rel="stylesheet" href="_static/clickable.css" type="text/css" />
    <link rel="stylesheet" href="_static/pytutor.css" type="text/css" />
    <link rel="stylesheet" href="_static/modal-basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/datafile.css" type="text/css" />
    <link rel="stylesheet" href="_static/dragndrop.css" type="text/css" />
    <link rel="stylesheet" href="_static/fitb.css" type="text/css" />
    <link rel="stylesheet" href="_static/codemirror.css" type="text/css" />
    <link rel="stylesheet" href="_static/livecode.css" type="text/css" />
    <link rel="stylesheet" href="_static/parsons.css" type="text/css" />
    <link rel="stylesheet" href="_static/lib/prettify.css" type="text/css" />
    <link rel="stylesheet" href="_static/poll.css" type="text/css" />
    <link rel="stylesheet" href="_static/tabbedstuff.css" type="text/css" />
    <link rel="stylesheet" href="_static/video.css" type="text/css" />
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootswatch/2.3.1/""/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/jquery-ui-1.10.3.custom.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/user-highlights.css" type="text/css" />
    <link rel="stylesheet" href="_static/runestone-custom-sphinx-bootstrap.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/runestonebase.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/jquery.highlight.js"></script>
    <script type="text/javascript" src="_static/bookfuncs.js"></script>
    <script type="text/javascript" src="_static/codemirror.js"></script>
    <script type="text/javascript" src="_static/xml.js"></script>
    <script type="text/javascript" src="_static/css.js"></script>
    <script type="text/javascript" src="_static/htmlmixed.js"></script>
    <script type="text/javascript" src="_static/python.js"></script>
    <script type="text/javascript" src="_static/javascript.js"></script>
    <script type="text/javascript" src="_static/activecode.js"></script>
    <script type="text/javascript" src="_static/skulpt.min.js"></script>
    <script type="text/javascript" src="_static/skulpt-stdlib.js"></script>
    <script type="text/javascript" src="_static/clike.js"></script>
    <script type="text/javascript" src="_static/timed_activecode.js"></script>
    <script type="text/javascript" src="_static/animationbase.js"></script>
    <script type="text/javascript" src="_static/mchoice.js"></script>
    <script type="text/javascript" src="_static/timedmc.js"></script>
    <script type="text/javascript" src="_static/timed.js"></script>
    <script type="text/javascript" src="_static/clickable.js"></script>
    <script type="text/javascript" src="_static/timedclickable.js"></script>
    <script type="text/javascript" src="_static/d3.v2.min.js"></script>
    <script type="text/javascript" src="_static/jquery.ba-bbq.min.js"></script>
    <script type="text/javascript" src="_static/jquery.jsPlumb-1.3.10-all-min.js"></script>
    <script type="text/javascript" src="_static/pytutor.js"></script>
    <script type="text/javascript" src="_static/codelens.js"></script>
    <script type="text/javascript" src="_static/skulpt.min.js"></script>
    <script type="text/javascript" src="_static/skulpt-stdlib.js"></script>
    <script type="text/javascript" src="_static/datafile.js"></script>
    <script type="text/javascript" src="_static/dragndrop.js"></script>
    <script type="text/javascript" src="_static/timeddnd.js"></script>
    <script type="text/javascript" src="_static/fitb.js"></script>
    <script type="text/javascript" src="_static/timedfitb.js"></script>
    <script type="text/javascript" src="_static/livecode.js"></script>
    <script type="text/javascript" src="_static/clike.js"></script>
    <script type="text/javascript" src="_static/lib/prettify.js"></script>
    <script type="text/javascript" src="_static/lib/hammer.min.js"></script>
    <script type="text/javascript" src="_static/parsons.js"></script>
    <script type="text/javascript" src="_static/timedparsons.js"></script>
    <script type="text/javascript" src="_static/poll.js"></script>
    <script type="text/javascript" src="_static/reveal.js"></script>
    <script type="text/javascript" src="_static/shortanswer.js"></script>
    <script type="text/javascript" src="_static/timed_shortanswer.js"></script>
    <script type="text/javascript" src="_static/tabbedstuff.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/jquery-ui-1.10.3.custom.min.js"></script>
    <script type="text/javascript" src="_static/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <script type="text/javascript" src="_static/waypoints.min.js"></script>
    <script type="text/javascript" src="_static/rangy-core.js"></script>
    <script type="text/javascript" src="_static/rangy-textrange.js"></script>
    <script type="text/javascript" src="_static/rangy-cssclassapplier.js"></script>
    <script type="text/javascript" src="_static/user-highlights.js"></script>
    <script type="text/javascript" src="_static/jquery.idle-timer.js"></script>
    <script type="text/javascript" src="_static/processing-1.4.1.min.js"></script>
    <script type="text/javascript" src="_static/jquery.hotkey.js"></script>
    <script type="text/javascript" src="_static/jquery-migrate-1.2.1.min.js"></script>
    <link rel="top" title="Runestone Interactive Overview" href="index.html" />
    <link rel="up" title="1. Processing Data with Excel" href="excel_toctree.html" />
    <link rel="next" title="1.13. Excel: Association Rules, i.e. Market Basket Analysis" href="h7.html" />
    <link rel="prev" title="1.11. Excel: Append, i.e. OFFSET() Function" href="h5.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
<link rel="shortcut icon" href="/runestone/static/favicon.ico" type="image/ico" />

<script type="text/javascript">
  eBookConfig = {};
  eBookConfig.host = 'http://127.0.0.1:8000' ? 'http://127.0.0.1:8000' : 'http://127.0.0.1:8000';
  eBookConfig.app = eBookConfig.host+'/runestone';
  eBookConfig.ajaxURL = eBookConfig.app+'/ajax/';
  eBookConfig.course = 'dsci210';
  eBookConfig.logLevel = 0;
  eBookConfig.loginRequired = false;
  eBookConfig.build_info = "unknown";
  eBookConfig.isLoggedIn = false;
  eBookConfig.useRunestoneServices = false;
  eBookConfig.python3 = true;
  eBookConfig.basecourse = 'dsci210';
</script>

<div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&status=0";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>



  </head>
  <body role="document">


<!-- Begin navbar -->
<div id="navbar" class="navbar navbar-default navbar-fixed-top" role="navigation">

  <div class="container">

    <div class="navbar-header">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type='button' class='navbar-toggle' data-toggle="collapse" data-target=".navbar-ex1-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div>
        <a class="brand-logo" style='background: transparent url("_static/img/logo_small.png") no-repeat 0px 0px;' href="/runestone/default/user/login">&nbsp; </a>
        <a class="navbar-brand" href="index.html">DSCI 210 Notes</a>
      </div>
    </div>

    <div class="navbar-collapse collapse navbar-ex1-collapse">

      <ul class="nav navbar-nav navbar-right">

        <li class="divider-vertical"></li>

        <!-- social media dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-share-alt" style="opacity: 0.9"></i>
          </a>
          <ul class="dropdown-menu social-menu">
              <li>
                <div>
                  <b>Runestone in social media:</b>
                </div>
                <a href="https://twitter.com/iRunestone" class="twitter-follow-button" data-show-count="true">Follow @iRunestone</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                <div class="fb-like" data-href="https://www.facebook.com/RunestoneInteractive" data-send="false" data-layout="button_count" data-width="300" data-show-faces="false" data-font="arial"></div>
              </li>

              <li class="divider"></li>
              <li>
                <div>
                  <b>Help support us:</b>
                </div>
                <div>
                    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
                  <input type="hidden" name="cmd" value="_s-xclick">
                  <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7-----
                  ">
                  <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
                  <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
                  </form>

                </div>
              </li>
          </ul>
        </li>
        <!-- end social media dropdown -->

        <li class="divider-vertical"></li>

        <!-- search dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-search" style='opacity:0.9;'></i>
          </a>
          <ul class='dropdown-menu'>
            
                <li><a href='index.html'>Table of Contents</a></li>
            
            <li><a href='/runestone/static/dsci210/genindex.html'>Book Index</a></li>
            <li class="divider"></li>
            <li id="scratch_ac_link"><a href="javascript:ACFactory.toggleScratchActivecode()">Scratch ActiveCode</a></li>
            <li class="divider"></li>
            <li style="width: 240px;">
              <form class="navbar-search" style="margin:10px;" action="search.html" method="get">
                <div class="input-group">
                  <input type="text" class="form-control" name="q" placeholder="Search this book" />
                  <span class="input-group-btn">
                    <button class="btn btn-primary" style="margin:0;" type="submit">
                      <i class="glyphicon glyphicon-search"></i>
                    </button>
                  </span>
                </div><!-- /input-group -->
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
            </li>
          </ul>
        </li>
        <!-- end search dropdown -->

        <li class="divider-vertical"></li>

        
        <li class="divider-vertical"></li>

        <!-- help menu dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-question-sign" style="opacity:0.9;"></i>
          </a>
          <ul class="dropdown-menu user-menu">
            <li><a href='/runestone/static/dsci210/navhelp.html'>Navigation Help</a></li>
            <li><a href='/runestone/static/overview/instructor.html'>Help for Instructors</a></li>
            <li class="divider"></li>
            <li><a href='http://runestoneinteractive.org'>About Runestone</a></li>
            <li><a href='/runestone/default/reportabug?course=dsci210&page=h6'>Report A Problem</a></li>
          </ul>
        </li>
        <!-- end help menu dropdown -->

        <li class="divider-vertical"></li>

      </ul>

      <ul class="nav navbar-nav">
        <li class="divider-vertical"></li>
        <!--
          <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">1.12. Excel: Merge Tables, i.e. MATCH() / INDEX() Functions</a><ul>
<li><a class="reference internal" href="#merging-content-from-tables">1.12.1. Merging Content from Tables</a></li>
<li><a class="reference internal" href="#using-match-and-index-to-merge-tables">1.12.2. Using =MATCH() and =INDEX() to Merge Tables</a></li>
<li><a class="reference internal" href="#working-with-complete-dataset">1.12.3. Working with Complete Dataset</a></li>
<li><a class="reference internal" href="#summaries-using-merged-content">1.12.4. Summaries using Merged Content</a></li>
</ul>
</li>
</ul>
</ul>
</li>
          <li class="divider-vertical"></li>
        
        
          
  <li id="relations-prev" title="Previous Chapter - 1.11. Excel: Append, i.e. OFFSET() Function" data-toggle="tooltip">
    <a href="h5.html" >
      <i class='glyphicon glyphicon-backward' style='opacity:0.9;'></i>
    </a>
  </li>
  
  <li id="relations-next" title='Next Chapter - 1.13. Excel: Association Rules, i.e. Market Basket Analysis' data-toggle="tooltip" >
    <a href="h7.html" >
      <i class='glyphicon glyphicon-forward' style='opacity:0.9;'></i>
    </a>
  </li>
  <li class="divider-vertical"></li>

<script type="text/javascript">
  opts = {'placement':'bottom',
          'selector': '',
          'delay': { show: 100, hide: 50}
         };

  $('#relations-prev').tooltip(opts);
  $('#relations-next').tooltip(opts);
</script>
        -->
        
          <li></li>
        
      </ul>

    </div>
  </div>
</div>


<div class="container" id="continue-reading"></div>

<div class="container" id="main-content">
  
  <div class="section" id="excel-merge-tables-i-e-match-index-functions">
<h1>1.12. Excel: Merge Tables, i.e. MATCH() / INDEX() Functions<a class="headerlink" href="#excel-merge-tables-i-e-match-index-functions" title="Permalink to this headline">¶</a></h1>
<div class="section" id="merging-content-from-tables">
<h2>1.12.1. Merging Content from Tables<a class="headerlink" href="#merging-content-from-tables" title="Permalink to this headline">¶</a></h2>
<p>A data scientist must often merge data from one table into another
table. The discussion here will again use the subset of the CO snowfall
data from above. Table A consists of the stacked data from the example
discussed above. Table B contains information auxiliary information for
various stations in CO.</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><p class="first">Stacked data from above example</p>
<p class="last"><a class="reference internal" href="_images/image160.png"><img alt="image0" src="_images/image160.png" style="width: 2.20149in; height: 2.33166in;" /></a></p>
</td>
<td><p class="first">Auxiliary information for weather stations in CO</p>
<p class="last"><a class="reference internal" href="_images/image240.png"><img alt="image1" src="_images/image240.png" style="width: 2.90987in; height: 1.49254in;" /></a></p>
</td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal"><span class="pre">=VLOOKUP()</span></code> function in Excel can be used to merge the content from
one table into another.</p>
<p><a class="reference internal" href="_images/image328.png"><img alt="image2" src="_images/image328.png" style="width: 4.30208in; height: 0.58333in;" /></a></p>
<ul class="simple">
<li>First argument: specifies the value to be looked up</li>
<li>Second argument: specifies the cell range of Table B or a subset of
Table B</li>
<li>Third arugment: an index that specifies which column is used to
retrieve content from Table B</li>
<li>Fourth argument: This should be set to <code class="docutils literal"><span class="pre">FALSE</span></code>. <code class="docutils literal"><span class="pre">FALSE</span></code> forces <code class="docutils literal"><span class="pre">=VLOOKUP()</span></code>
to find an exact match</li>
</ul>
<p>The following provides a visualization of the <code class="docutils literal"><span class="pre">=VLOOKUP()</span></code> function for
cell F9.</p>
<p><a class="reference internal" href="_images/image424.png"><img alt="image3" src="_images/image424.png" style="width: 5.50746in; height: 1.82876in;" /></a></p>
<div class="admonition-note admonition">
<p class="first admonition-title">Note:</p>
<p class="last">Table B may or may not be contained in the same worksheet as
Table A.</p>
</div>
<p>In this example, the second argument (i.e. the table array) is specified
as K2:N8. If the Latitude value is to be returned, then the column index
should be set to 3.</p>
<p><a class="reference internal" href="_images/image514.png"><img alt="image4" src="_images/image514.png" style="width: 3.99254in; height: 1.78404in;" /></a></p>
<p>Type the following formula into cell F2.</p>
<p>Cell F2: <code class="docutils literal"><span class="pre">=VLOOKUP(</span> <span class="pre">B2</span> <span class="pre">,</span> <span class="pre">$K$2:$N$8</span> <span class="pre">,</span> <span class="pre">3</span> <span class="pre">,</span> <span class="pre">FALSE</span> <span class="pre">)</span></code></p>
<p><a class="reference internal" href="_images/image613.png"><img alt="image5" src="_images/image613.png" style="width: 4.50731in; height: 0.75373in;" /></a></p>
<p>Copy this formula down for the remaining cells.</p>
<p><a class="reference internal" href="_images/image713.png"><img alt="image6" src="_images/image713.png" style="width: 4.99254in; height: 0.85823in;" /></a></p>
<p>Repeat this process for Longitude by typing the following into cell G2
and copying down for all cells.</p>
<p>Cell G2: <code class="docutils literal"><span class="pre">=VLOOKUP(</span> <span class="pre">B2</span> <span class="pre">,</span> <span class="pre">$K$2:$N$8</span> <span class="pre">,</span> <span class="pre">4</span> <span class="pre">,</span> <span class="pre">FALSE</span> <span class="pre">)</span></code></p>
<p><a class="reference internal" href="_images/image813.png"><img alt="image7" src="_images/image813.png" style="width: 3.88003in; height: 2.52239in;" /></a></p>
<p>Next, suppose County is to be merged into Table A. The =VLOOKUP()
function will not work for County as this function always uses the
left-most column of the table array to search for a match. The
<code class="docutils literal"><span class="pre">=VLOOKUP()</span></code> function fails here because Station is not the left-most
column of the table array.</p>
<table border="1" class="docutils">
<colgroup>
<col width="82%" />
<col width="18%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><p class="first">The following will not work.</p>
<p class="last">Cell H2: <code class="docutils literal"><span class="pre">=VLOOKUP(B2</span> <span class="pre">,</span> <span class="pre">$J$2:$N$8</span> <span class="pre">,</span> <span class="pre">1</span> <span class="pre">,</span> <span class="pre">FALSE</span> <span class="pre">)</span></code></p>
</td>
<td><a class="reference internal" href="_images/image912.png"><img alt="image8" src="_images/image912.png" style="width: 1.03200in; height: 0.36511in;" /></a></td>
</tr>
</tbody>
</table>
<p>The column containing the lookup value must be the left-most column of
the table array.</p>
<p><a class="reference internal" href="_images/image1013.png"><img alt="image9" src="_images/image1013.png" style="width: 4.44800in; height: 1.56868in;" /></a></p>
</div>
<div class="section" id="using-match-and-index-to-merge-tables">
<h2>1.12.2. Using =MATCH() and =INDEX() to Merge Tables<a class="headerlink" href="#using-match-and-index-to-merge-tables" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">=MATCH()</span></code> / <code class="docutils literal"><span class="pre">=INDEX()</span></code> approach to merging tables in Excel is
considered to be better than <code class="docutils literal"><span class="pre">=VLOOKUP()</span></code>. This method requires two steps.</p>
<p>Suppose the County for RowID 7 is to be obtained. The <code class="docutils literal"><span class="pre">=MATCH()</span></code> function
does not return the requested content from Table B, but instead returns
the row number of Table B that matches the lookup value.</p>
<p><a class="reference internal" href="_images/image1117.png"><img alt="image10" src="_images/image1117.png" style="width: 5.25373in; height: 1.66761in;" /></a></p>
<p>The second step of this process is to retrieve the actual contents from
Table B. This is done using the <code class="docutils literal"><span class="pre">=INDEX()</span></code> function. The <code class="docutils literal"><span class="pre">=INDEX()</span></code> function
is similar to the <code class="docutils literal"><span class="pre">=OFFSET()</span></code> function used earlier. <code class="docutils literal"><span class="pre">=OFFSET()</span></code> required
the specification of a single cell to be used as a reference. <code class="docutils literal"><span class="pre">INDEX()</span></code>
requires specification of the entire range of cells along with
information regarding which row and column to return.</p>
<table border="1" class="docutils">
<colgroup>
<col width="56%" />
<col width="44%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><p class="first">Specify $K$2:$P$8 as the cell range for =INDEX() function</p>
<p class="last"><a class="reference internal" href="_images/image1214.png"><img alt="image11" src="_images/image1214.png" style="width: 2.91045in; height: 0.97193in;" /></a></p>
</td>
<td><p class="first">=INDEX() will return EL PASO, CO for RowID 7</p>
<p class="last"><a class="reference internal" href="_images/image1313.png"><img alt="image12" src="_images/image1313.png" style="width: 3.26866in; height: 1.39494in;" /></a></p>
</td>
</tr>
</tbody>
</table>
<p>Type the following formulas into Excel and copy these formulas down for
all remaining cells.</p>
<p>Cell H2: <code class="docutils literal"><span class="pre">=MATCH(</span> <span class="pre">B2</span> <span class="pre">,</span> <span class="pre">$M$2,$M$8</span> <span class="pre">,</span> <span class="pre">0</span> <span class="pre">)</span></code></p>
<p>Cell I2: <code class="docutils literal"><span class="pre">=INDEX(</span> <span class="pre">$K$2:$P$8,H2</span> <span class="pre">,</span> <span class="pre">2</span> <span class="pre">)</span></code></p>
<p><a class="reference internal" href="_images/image1412.png"><img alt="image13" src="_images/image1412.png" style="width: 5.52985in; height: 0.64810in;" /></a></p>
<div class="admonition-questions admonition">
<p class="first admonition-title">Questions</p>
<ol class="last arabic simple">
<li>What is the purpose of the third argument in the <code class="docutils literal"><span class="pre">=MATCH()</span></code> function?</li>
<li>Why is 2 specified as the last argument in the <code class="docutils literal"><span class="pre">=INDEX()</span></code> function?</li>
</ol>
</div>
<p>The following table is a successful merge of County from Table B into
Table A.</p>
<p><a class="reference internal" href="_images/image1512.png"><img alt="image14" src="_images/image1512.png" style="width: 4.41980in; height: 2.52985in;" /></a></p>
<p>After the successful merging these two tables, averages can now be
computed over county as is shown here. The latitude and longitude values
are necessary for mapping snowfall.</p>
<p><a class="reference internal" href="_images/image1612.png"><img alt="image15" src="_images/image1612.png" style="width: 2.82156in; height: 1.14925in;" /></a></p>
</div>
<div class="section" id="working-with-complete-dataset">
<h2>1.12.3. Working with Complete Dataset<a class="headerlink" href="#working-with-complete-dataset" title="Permalink to this headline">¶</a></h2>
<p>Import the station data into Excel. Select Data &gt; From Text, specify
Fixed width in Step 1 of the import wizard. The following snippet shows
the first few rows of the station dataset.</p>
<p><a class="reference internal" href="_images/image1710.png"><img alt="image16" src="_images/image1710.png" style="width: 5.29851in; height: 1.13103in;" /></a></p>
<p>In Excel, name this worksheet StationInfo on the tab near the lower-left
corner.</p>
<p><a class="reference internal" href="_images/image1810.png"><img alt="image17" src="_images/image1810.png" style="width: 3.69792in; height: 0.36458in;" /></a></p>
<p>The station dataset contains information on many stations that are not
present in our dataset. Also, several stations are replicated because
new weather stations are added and others are removed from time to time.
The <code class="docutils literal"><span class="pre">=MATCH()</span></code> and <code class="docutils literal"><span class="pre">=VLOOKUP()</span></code> functions use the first instance of a match.
These functions ignore rows after an exact match is found.</p>
<p>Assuming you have named the worksheet containing the station data
StationInfo, type the following into cell E2 in the stacked version of
the snowfall dataset. Column E is being used in this formula as this
column contains the Station IDs in Table B.</p>
<p>Cell E2: <code class="docutils literal"><span class="pre">=MATCH(B2,</span> <span class="pre">StationInfo!$E$2:$E$3091,</span> <span class="pre">0</span> <span class="pre">)</span></code></p>
<p><a class="reference internal" href="_images/image1910.png"><img alt="image18" src="_images/image1910.png" style="width: 6.50000in; height: 0.87778in;" /></a></p>
<p>Copy this formula down for all cells. Some Station IDs from Table A
cannot be found in Table B. In this case, a #N/A values is appropriately
retuned by the <code class="docutils literal"><span class="pre">=MATCH()</span></code> function. This formula will not provide a County
name when an #N/A is returned by the <code class="docutils literal"><span class="pre">=MATCH()</span></code> function. Next, the
<code class="docutils literal"><span class="pre">=INDEX()</span></code> function can be used to retrieve County from Table B.</p>
<p>Cell F2: <code class="docutils literal"><span class="pre">=IF(</span> <span class="pre">ISERROR(E2)</span> <span class="pre">,</span> <span class="pre">””</span> <span class="pre">,</span> <span class="pre">INDEX(</span> <span class="pre">StationInfo!$A$2:$N$3091</span> <span class="pre">,</span> <span class="pre">E2</span> <span class="pre">,</span>
<span class="pre">4</span> <span class="pre">))</span></code></p>
<p><a class="reference internal" href="_images/image208.png"><img alt="image19" src="_images/image208.png" style="width: 6.50000in; height: 0.79722in;" /></a></p>
<p>The following shows a successful merge of the County information from
the StationInfo worksheet into the Snowfall dataset.</p>
<p><a class="reference internal" href="_images/image2113.png"><img alt="image20" src="_images/image2113.png" style="width: 4.50746in; height: 1.22029in;" /></a></p>
<p>Next, in column G, the following formula can be used to merge Elevation
from the StationInfo worksheet into the dataset.</p>
<p><code class="docutils literal"><span class="pre">=IF(</span> <span class="pre">ISERROR(E2),</span> <span class="pre">&quot;&quot;,</span> <span class="pre">INDEX(StationInfo!$A$2:$N$3091,</span> <span class="pre">E2,</span> <span class="pre">14</span> <span class="pre">)</span> <span class="pre">)</span></code></p>
<div class="admonition-questions admonition">
<p class="first admonition-title">Questions</p>
<ol class="last arabic">
<li><p class="first">What is the purpose of the empty string, i.e. “”, in the formula
above?</p>
</li>
<li><p class="first">What happens if the following is used in cell F2 instead of the
formula provided above for merging County?</p>
<p>Cell F2: <code class="docutils literal"><span class="pre">=INDEX(StationInfo!$A$2:$N$3091,E2,4)</span></code></p>
</li>
<li><p class="first">Some software packages will create maps based on county names.
However, abbreviations for state must be included with the county
name. Use the following formula to concatenate County with the state
abbreviation for CO.</p>
<p>Cell G2: <code class="docutils literal"><span class="pre">=IF(ISERROR(E2),</span> <span class="pre">“”,</span> <span class="pre">CONCATENATE(F2,”,</span> <span class="pre">CO“)</span> <span class="pre">)</span></code></p>
</li>
</ol>
</div>
</div>
<div class="section" id="summaries-using-merged-content">
<h2>1.12.4. Summaries using Merged Content<a class="headerlink" href="#summaries-using-merged-content" title="Permalink to this headline">¶</a></h2>
<p>A summary of total snowfall by county is being requested by your boss.
You have successfully merged these dataset and create the following
PivotTable.</p>
<table border="1" class="docutils">
<colgroup>
<col width="39%" />
<col width="61%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><p class="first">Snowfall by County</p>
<p class="last"><a class="reference internal" href="_images/image2212.png"><img alt="image21" src="_images/image2212.png" style="width: 2.15972in; height: 2.31792in;" /></a></p>
</td>
<td><div class="first line-block">
<div class="line">The PivotTable structure used</div>
<div class="line">to create this table</div>
</div>
<p class="last"><a class="reference internal" href="_images/image2311.png"><img alt="image22" src="_images/image2311.png" style="width: 3.50000in; height: 0.81473in;" /></a></p>
</td>
</tr>
</tbody>
</table>
<p>A map of the counties in Colorado is given here for reference.</p>
<p><a class="reference internal" href="_images/image248.png"><img alt="image23" src="_images/image248.png" style="width: 3.56125in; height: 2.56250in;" /></a></p>
<div class="admonition-questions admonition">
<p class="first admonition-title">Questions</p>
<ol class="last arabic simple">
<li>Your boss makes the following comment, “There is no way El Paso
County has 120 weather stations.” Your boss is correct. How many
weather stations does El Paso County have in this dataset?</li>
<li>The SUM is being used here as the total snowfall over the entire year
is of interest. I’d argue that a SUM should not be used as the number
of stations per county is not the same. Do you agree or disagree?
Explain.</li>
</ol>
</div>
<p>A PivotTable based on averages, instead of totals, is shown below.</p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="62%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><p class="first">Average Snowfall by County</p>
<p class="last"><a class="reference internal" href="_images/image257.png"><img alt="image24" src="_images/image257.png" style="width: 1.30217in; height: 2.59722in;" /></a></p>
</td>
<td><p class="first">Pareto-type chart of average snowfall amounts</p>
<p class="last"><a class="reference internal" href="_images/image267.png"><img alt="image25" src="_images/image267.png" style="width: 4.54861in; height: 1.54633in;" /></a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition-questions admonition">
<p class="first admonition-title">Questions</p>
<ol class="arabic simple">
<li>The average snowfall for Mineral County is 15.8 inches. Provide an
interpretation for this value.</li>
<li>I’d argue that the averages provided here collapse the data too much.
For example, do you believe the average for Mineral County provided
above is a good estimate for snowfall in July? How about January?
Discuss.</li>
<li>The following table shows the snowfall by month across counties in
CO. Recreate this table in Excel.</li>
</ol>
<p><a class="reference internal" href="_images/image277.png"><img alt="image26" src="_images/image277.png" style="width: 4.26119in; height: 2.47424in;" /></a></p>
<ol class="arabic simple" start="4">
<li>The following visualization is from the PivotTable provided above. Is
it true that for most of these counties the snowfall amount increase
from Oct through Dec? Is it true that snowfall tends to steadily
decrease from Jan through Apr?</li>
</ol>
<p><a class="reference internal" href="_images/image287.png"><img alt="image27" src="_images/image287.png" style="width: 4.02778in; height: 2.84268in;" /></a></p>
<ol class="arabic simple" start="5">
<li>Consider the following graphs that show the relationship between
elevation and snowfall. For January, does elevation have much impact
below 6,000 feet? What can be said about Point A in this plot?
Consider the plot that includes data from March? Is there much of a
difference in the relationship between elevation and snowfall amounts
between January and March? Discuss.</li>
</ol>
<table border="1" class="last docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="_images/image296.png"><img alt="image28" src="_images/image296.png" style="width: 2.91667in; height: 2.04025in;" /></a></td>
<td><a class="reference internal" href="_images/image306.png"><img alt="image29" src="_images/image306.png" style="width: 3.11018in; height: 2.06944in;" /></a></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


  
      
  <li id="relations-prev" class="navLink" title='Previous Section - 1.11. Excel: Append, i.e. OFFSET() Function' data-toggle="tooltip">
    <a href="h5.html" >
      <i class='prevNav glyphicon glyphicon-chevron-left'></i>
    </a>
  </li>
  <a class="navLinkBg" id="navLinkBgLeft"  href="h5.html" ></a>
  
  <li id="relations-next" class="navLink" title='Next Section - 1.13. Excel: Association Rules, i.e. Market Basket Analysis' data-toggle="tooltip" >
    <a href="h7.html" >
      <i id="relationsNextIcon" class='nextNav glyphicon glyphicon-chevron-right'></i>
    </a>
  </li>
  <a class="navLinkBg navLink" id="navLinkBgRight" href="h7.html" >Next Section - 1.13. Excel: Association Rules, i.e. Market Basket Analysis</a>

<script type="text/javascript">

  $('#relations-prev').tooltip({'placement':'right', 'selector': '', 'delay': { show: 100, hide: 50}});
  $('#relations-next').tooltip({'placement':'left', 'selector': '', 'delay': { show: 100, hide: 50}});
  
</script>
  
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      
      | <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2015 Todd Iverson.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.4.5.
    </p>
  </div>
</footer>



<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-32029811-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



  </body>
</html>