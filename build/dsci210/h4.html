<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>1.10. Excel: Pivot Tables in Excel &mdash; Runestone Interactive Overview</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.0.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/codemirror.css" type="text/css" />
    <link rel="stylesheet" href="_static/activecode.css" type="text/css" />
    <link rel="stylesheet" href="_static/clickable.css" type="text/css" />
    <link rel="stylesheet" href="_static/pytutor.css" type="text/css" />
    <link rel="stylesheet" href="_static/modal-basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/datafile.css" type="text/css" />
    <link rel="stylesheet" href="_static/dragndrop.css" type="text/css" />
    <link rel="stylesheet" href="_static/fitb.css" type="text/css" />
    <link rel="stylesheet" href="_static/codemirror.css" type="text/css" />
    <link rel="stylesheet" href="_static/livecode.css" type="text/css" />
    <link rel="stylesheet" href="_static/parsons.css" type="text/css" />
    <link rel="stylesheet" href="_static/lib/prettify.css" type="text/css" />
    <link rel="stylesheet" href="_static/poll.css" type="text/css" />
    <link rel="stylesheet" href="_static/tabbedstuff.css" type="text/css" />
    <link rel="stylesheet" href="_static/video.css" type="text/css" />
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootswatch/2.3.1/""/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/jquery-ui-1.10.3.custom.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/user-highlights.css" type="text/css" />
    <link rel="stylesheet" href="_static/runestone-custom-sphinx-bootstrap.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/runestonebase.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/jquery.highlight.js"></script>
    <script type="text/javascript" src="_static/bookfuncs.js"></script>
    <script type="text/javascript" src="_static/codemirror.js"></script>
    <script type="text/javascript" src="_static/xml.js"></script>
    <script type="text/javascript" src="_static/css.js"></script>
    <script type="text/javascript" src="_static/htmlmixed.js"></script>
    <script type="text/javascript" src="_static/python.js"></script>
    <script type="text/javascript" src="_static/javascript.js"></script>
    <script type="text/javascript" src="_static/activecode.js"></script>
    <script type="text/javascript" src="_static/skulpt.min.js"></script>
    <script type="text/javascript" src="_static/skulpt-stdlib.js"></script>
    <script type="text/javascript" src="_static/clike.js"></script>
    <script type="text/javascript" src="_static/timed_activecode.js"></script>
    <script type="text/javascript" src="_static/animationbase.js"></script>
    <script type="text/javascript" src="_static/mchoice.js"></script>
    <script type="text/javascript" src="_static/timedmc.js"></script>
    <script type="text/javascript" src="_static/timed.js"></script>
    <script type="text/javascript" src="_static/clickable.js"></script>
    <script type="text/javascript" src="_static/timedclickable.js"></script>
    <script type="text/javascript" src="_static/d3.v2.min.js"></script>
    <script type="text/javascript" src="_static/jquery.ba-bbq.min.js"></script>
    <script type="text/javascript" src="_static/jquery.jsPlumb-1.3.10-all-min.js"></script>
    <script type="text/javascript" src="_static/pytutor.js"></script>
    <script type="text/javascript" src="_static/codelens.js"></script>
    <script type="text/javascript" src="_static/skulpt.min.js"></script>
    <script type="text/javascript" src="_static/skulpt-stdlib.js"></script>
    <script type="text/javascript" src="_static/datafile.js"></script>
    <script type="text/javascript" src="_static/dragndrop.js"></script>
    <script type="text/javascript" src="_static/timeddnd.js"></script>
    <script type="text/javascript" src="_static/fitb.js"></script>
    <script type="text/javascript" src="_static/timedfitb.js"></script>
    <script type="text/javascript" src="_static/livecode.js"></script>
    <script type="text/javascript" src="_static/clike.js"></script>
    <script type="text/javascript" src="_static/lib/prettify.js"></script>
    <script type="text/javascript" src="_static/lib/hammer.min.js"></script>
    <script type="text/javascript" src="_static/parsons.js"></script>
    <script type="text/javascript" src="_static/timedparsons.js"></script>
    <script type="text/javascript" src="_static/poll.js"></script>
    <script type="text/javascript" src="_static/reveal.js"></script>
    <script type="text/javascript" src="_static/shortanswer.js"></script>
    <script type="text/javascript" src="_static/timed_shortanswer.js"></script>
    <script type="text/javascript" src="_static/tabbedstuff.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/jquery-ui-1.10.3.custom.min.js"></script>
    <script type="text/javascript" src="_static/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <script type="text/javascript" src="_static/waypoints.min.js"></script>
    <script type="text/javascript" src="_static/rangy-core.js"></script>
    <script type="text/javascript" src="_static/rangy-textrange.js"></script>
    <script type="text/javascript" src="_static/rangy-cssclassapplier.js"></script>
    <script type="text/javascript" src="_static/user-highlights.js"></script>
    <script type="text/javascript" src="_static/jquery.idle-timer.js"></script>
    <script type="text/javascript" src="_static/processing-1.4.1.min.js"></script>
    <script type="text/javascript" src="_static/jquery.hotkey.js"></script>
    <script type="text/javascript" src="_static/jquery-migrate-1.2.1.min.js"></script>
    <link rel="top" title="Runestone Interactive Overview" href="index.html" />
    <link rel="up" title="1. Processing Data with Excel" href="excel_toctree.html" />
    <link rel="next" title="1.11. Excel: Append, i.e. OFFSET() Function" href="h5.html" />
    <link rel="prev" title="1.9. Excel: Basic String Functions" href="h3.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
<link rel="shortcut icon" href="/runestone/static/favicon.ico" type="image/ico" />

<script type="text/javascript">
  eBookConfig = {};
  eBookConfig.host = 'http://127.0.0.1:8000' ? 'http://127.0.0.1:8000' : 'http://127.0.0.1:8000';
  eBookConfig.app = eBookConfig.host+'/runestone';
  eBookConfig.ajaxURL = eBookConfig.app+'/ajax/';
  eBookConfig.course = 'dsci210';
  eBookConfig.logLevel = 0;
  eBookConfig.loginRequired = false;
  eBookConfig.build_info = "unknown";
  eBookConfig.isLoggedIn = false;
  eBookConfig.useRunestoneServices = false;
  eBookConfig.python3 = true;
  eBookConfig.basecourse = 'dsci210';
</script>

<div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&status=0";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>



  </head>
  <body role="document">


<!-- Begin navbar -->
<div id="navbar" class="navbar navbar-default navbar-fixed-top" role="navigation">

  <div class="container">

    <div class="navbar-header">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type='button' class='navbar-toggle' data-toggle="collapse" data-target=".navbar-ex1-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div>
        <a class="brand-logo" style='background: transparent url("_static/img/logo_small.png") no-repeat 0px 0px;' href="/runestone/default/user/login">&nbsp; </a>
        <a class="navbar-brand" href="index.html">DSCI 210 Notes</a>
      </div>
    </div>

    <div class="navbar-collapse collapse navbar-ex1-collapse">

      <ul class="nav navbar-nav navbar-right">

        <li class="divider-vertical"></li>

        <!-- social media dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-share-alt" style="opacity: 0.9"></i>
          </a>
          <ul class="dropdown-menu social-menu">
              <li>
                <div>
                  <b>Runestone in social media:</b>
                </div>
                <a href="https://twitter.com/iRunestone" class="twitter-follow-button" data-show-count="true">Follow @iRunestone</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                <div class="fb-like" data-href="https://www.facebook.com/RunestoneInteractive" data-send="false" data-layout="button_count" data-width="300" data-show-faces="false" data-font="arial"></div>
              </li>

              <li class="divider"></li>
              <li>
                <div>
                  <b>Help support us:</b>
                </div>
                <div>
                    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
                  <input type="hidden" name="cmd" value="_s-xclick">
                  <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7-----
                  ">
                  <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
                  <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
                  </form>

                </div>
              </li>
          </ul>
        </li>
        <!-- end social media dropdown -->

        <li class="divider-vertical"></li>

        <!-- search dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-search" style='opacity:0.9;'></i>
          </a>
          <ul class='dropdown-menu'>
            
                <li><a href='index.html'>Table of Contents</a></li>
            
            <li><a href='/runestone/static/dsci210/genindex.html'>Book Index</a></li>
            <li class="divider"></li>
            <li id="scratch_ac_link"><a href="javascript:ACFactory.toggleScratchActivecode()">Scratch ActiveCode</a></li>
            <li class="divider"></li>
            <li style="width: 240px;">
              <form class="navbar-search" style="margin:10px;" action="search.html" method="get">
                <div class="input-group">
                  <input type="text" class="form-control" name="q" placeholder="Search this book" />
                  <span class="input-group-btn">
                    <button class="btn btn-primary" style="margin:0;" type="submit">
                      <i class="glyphicon glyphicon-search"></i>
                    </button>
                  </span>
                </div><!-- /input-group -->
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
            </li>
          </ul>
        </li>
        <!-- end search dropdown -->

        <li class="divider-vertical"></li>

        
        <li class="divider-vertical"></li>

        <!-- help menu dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-question-sign" style="opacity:0.9;"></i>
          </a>
          <ul class="dropdown-menu user-menu">
            <li><a href='/runestone/static/dsci210/navhelp.html'>Navigation Help</a></li>
            <li><a href='/runestone/static/overview/instructor.html'>Help for Instructors</a></li>
            <li class="divider"></li>
            <li><a href='http://runestoneinteractive.org'>About Runestone</a></li>
            <li><a href='/runestone/default/reportabug?course=dsci210&page=h4'>Report A Problem</a></li>
          </ul>
        </li>
        <!-- end help menu dropdown -->

        <li class="divider-vertical"></li>

      </ul>

      <ul class="nav navbar-nav">
        <li class="divider-vertical"></li>
        <!--
          <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">1.10. Excel: Pivot Tables in Excel</a><ul>
<li><a class="reference internal" href="#getting-started">1.10.1. Getting Started…</a></li>
<li><a class="reference internal" href="#computing-percentages-is-not-necessarily-straight-forward">1.10.2. Computing percentages is not necessarily straight forward…</a></li>
<li><a class="reference internal" href="#computing-percentages-with-the-pivottable">1.10.3. Computing Percentages with the PivotTable</a></li>
<li><a class="reference internal" href="#working-with-two-or-more-variables">1.10.4. Working with Two or More Variables…</a></li>
<li><a class="reference internal" href="#pivot-tables-with-numerical-data">1.10.5. Pivot Tables with Numerical Data</a></li>
<li><a class="reference internal" href="#filtering-with-pivot-tables">1.10.6. Filtering with Pivot Tables</a></li>
</ul>
</li>
</ul>
</ul>
</li>
          <li class="divider-vertical"></li>
        
        
          
  <li id="relations-prev" title="Previous Chapter - 1.9. Excel: Basic String Functions" data-toggle="tooltip">
    <a href="h3.html" >
      <i class='glyphicon glyphicon-backward' style='opacity:0.9;'></i>
    </a>
  </li>
  
  <li id="relations-next" title='Next Chapter - 1.11. Excel: Append, i.e. OFFSET() Function' data-toggle="tooltip" >
    <a href="h5.html" >
      <i class='glyphicon glyphicon-forward' style='opacity:0.9;'></i>
    </a>
  </li>
  <li class="divider-vertical"></li>

<script type="text/javascript">
  opts = {'placement':'bottom',
          'selector': '',
          'delay': { show: 100, hide: 50}
         };

  $('#relations-prev').tooltip(opts);
  $('#relations-next').tooltip(opts);
</script>
        -->
        
          <li></li>
        
      </ul>

    </div>
  </div>
</div>


<div class="container" id="continue-reading"></div>

<div class="container" id="main-content">
  
  <div class="section" id="excel-pivot-tables-in-excel">
<h1>1.10. Excel: Pivot Tables in Excel<a class="headerlink" href="#excel-pivot-tables-in-excel" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="_images/image140.png"><img alt="image0" src="_images/image140.png" style="width: 6.50000in; height: 1.52128in;" /></a></p>
<div class="section" id="getting-started">
<h2>1.10.1. Getting Started…<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>To invoke the PivotTable wizard in Excel, first highlight the data that
you want to summarize. Select Insert &gt; PivotTable or PivotChart. The
PivotChart will produce a table as well as a chart; whereas the
PivotTable will produce only a table.</p>
<p><a class="reference internal" href="_images/image237.png"><img alt="image1" src="_images/image237.png" style="width: 3.90011in; height: 3.26042in;" /></a></p>
<p>In the Create PivotTable window, you must specify the data that you want
to analyze and a location for the output (or report) to be placed.</p>
<p><a class="reference internal" href="_images/image325.png"><img alt="image2" src="_images/image325.png" style="width: 4.07292in; height: 2.96875in;" /></a></p>
<p>On the new sheet, you will see an output area for the table and the
chart; also, a PivotTable Field List is shown on the right-hand side of
the window. To create your table and chart, place your first variable of
interest in the Axis Fields box near the bottom right corner of the
window.</p>
<p><a class="reference internal" href="_images/image419.png"><img alt="image3" src="_images/image419.png" style="width: 5.15625in; height: 2.97352in;" /></a></p>
<p>For example, suppose the variable of interest is <em>Gender</em>. To create a pivot
table for <em>Gender</em>, first place <em>Gender</em> in the Axis Fields box. Next, you must
tell Excel what you want to do with <em>Gender</em>. Dragging <em>Gender</em> into the Values
box will create a Count of <em>Gender</em>.</p>
<p><a class="reference internal" href="_images/image611.png"><img alt="image4" src="_images/image611.png" style="width: 3.58in; height: 4.24in;" /></a></p>
<p>To obtain a summary of the distribution of <em>Gender</em>, this variable
should be placed in the Axis Fields box and a Count of Gender should
appear in the Values box as is shown below.</p>
<p><a class="reference internal" href="_images/image711.png"><img alt="image5" src="_images/image711.png" style="width: 2.51917in; height: 1.71875in;" /></a></p>
<p>The table of counts and the chart are given here.</p>
<p><a class="reference internal" href="_images/image811.png"><img alt="image6" src="_images/image811.png" style="width: 4.66667in; height: 2.03467in;" /></a></p>
<p>Excel will often give a count of missing values. This dataset has no
missing values, thus, we can deselect this from the drop-down menu in
the Row Labels box.</p>
<p><a class="reference internal" href="_images/image910.png"><img alt="image7" src="_images/image910.png" style="width: 4.85417in; height: 2.60389in;" /></a></p>
</div>
<div class="section" id="computing-percentages-is-not-necessarily-straight-forward">
<h2>1.10.2. Computing percentages is not necessarily straight forward…<a class="headerlink" href="#computing-percentages-is-not-necessarily-straight-forward" title="Permalink to this headline">¶</a></h2>
<p>First, consider computing the appropriate percentages in a generic table
in Excel (i.e., not within the pivot table framework). The appropriate
formulas are given below.</p>
<p><a class="reference internal" href="_images/image1011.png"><img alt="image8" src="_images/image1011.png" style="width: 5.18750in; height: 1.03125in;" /></a></p>
<p>Recall that Excel automatically updates the cell references in formulas
when they are copied down and/or across cells. This can save LOTS of
time in certain situations; however, it can also cause problems if
you’re not careful. For example, suppose you entered the formula for
Females and copied it down to obtain the percentage of Males.</p>
<p><a class="reference internal" href="_images/image1115.png"><img alt="image9" src="_images/image1115.png" style="width: 6.44792in; height: 1.19792in;" /></a></p>
<p>After this formula is entered and copied down, a #DIV/0! error is
produced. This happens because the denominator in our formula is cell
B5, which is empty (and Excel treats this as a “0”). Since you cannot
divide by 0, Excel returns the error.</p>
<p><strong>Formula View:</strong>
<a class="reference internal" href="_images/image1212.png"><img alt="image10" src="_images/image1212.png" style="width: 6.50000in; height: 0.89583in;" /></a></p>
<p><strong>Data View:</strong>
<a class="reference internal" href="_images/image1311.png"><img alt="image11" src="_images/image1311.png" style="width: 6.37500in; height: 1.06250in;" /></a></p>
<p>As discussed earlier, absolute cell referencing can be used to prevent
this error from occurring. You can use the $ to force Excel to always
use cell B4 in the denominator as shown below.</p>
<p><a class="reference internal" href="_images/image1410.png"><img alt="image12" src="_images/image1410.png" style="width: 6.50000in; height: 0.83403in;" /></a></p>
<p>The final output…</p>
<p><a class="reference internal" href="_images/image1510.png"><img alt="image13" src="_images/image1510.png" style="width: 6.50000in; height: 0.83681in;" /></a></p>
<p>Unfortunately, obtaining the appropriate percentages with calculations
involving cells in the pivot table output is somewhat cumbersome because
Excel refers to these cells in very specific ways. For example, the
following “formula” is produced when you try to calculate a simple
percentage of 185/388 with the pivot table output:</p>
<p><a class="reference internal" href="_images/image1610.png"><img alt="image14" src="_images/image1610.png" style="width: 6.50000in; height: 0.93234in;" /></a></p>
<div class="admonition-question admonition">
<p class="first admonition-title">Question:</p>
<p class="last">Copy this formula down to obtain the percentage of Males in this dataset. What
happened? How do we fix the formula to obtain the correct percentage for Males?</p>
</div>
</div>
<div class="section" id="computing-percentages-with-the-pivottable">
<h2>1.10.3. Computing Percentages with the PivotTable<a class="headerlink" href="#computing-percentages-with-the-pivottable" title="Permalink to this headline">¶</a></h2>
<p>The PivotTable does have the ability to compute percentages
automatically. The instructions below will result in a table containing
both counts and their corresponding percentages.</p>
<p>When constructing the PivotTable, place <em>Gender</em> in the Values box
<em>twice</em>.</p>
<p><a class="reference internal" href="_images/image178.png"><img alt="image15" src="_images/image178.png" style="width: 2.18750in; height: 0.93002in;" /></a></p>
<p>Your table should now contain two columns, as is shown here. Right-click
on the column header for which you want to compute percentages and
select “Value Field Settings…”</p>
<p><a class="reference internal" href="_images/image188.png"><img alt="image16" src="_images/image188.png" style="width: 3.04167in; height: 1.64360in;" /></a></p>
<p>Under the Show values as tab, select <strong>% of Column Total</strong> from the
drop-down list. Click OK.</p>
<p><a class="reference internal" href="_images/image198.png"><img alt="image17" src="_images/image198.png" style="width: 2.52083in; height: 2.22755in;" /></a></p>
<p>The following table contains the desired outcomes.</p>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="29%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Gender</strong></th>
<th class="head"><strong>Count</strong></th>
<th class="head"><strong>Percentage</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Female</td>
<td>185</td>
<td>47.68%</td>
</tr>
<tr class="row-odd"><td>Male</td>
<td>203</td>
<td>52.32%</td>
</tr>
<tr class="row-even"><td><strong>Total</strong></td>
<td><strong>388</strong></td>
<td><strong>100.00%</strong></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="working-with-two-or-more-variables">
<h2>1.10.4. Working with Two or More Variables…<a class="headerlink" href="#working-with-two-or-more-variables" title="Permalink to this headline">¶</a></h2>
<p>Suppose the goal is to understand the relationship between <em>Gender</em> and
<em>Cell Phone Involved</em>. To create this pivot table, click on the space
set aside for the pivot table and place <em>Gender</em> in the Column Labels
box and <em>Cell Phone Involved</em> in the Row Labels box (note that if you
click on the space set aside for the chart, you should place <em>Gender</em> in
the Axis Field box and <em>Cell Phone Involved</em> in the Legend Fields box).
Then, place either one of the variables in the Values box. Excel will
calculate the counts by default.</p>
<p><a class="reference internal" href="_images/image364.png"><img alt="image32" src="_images/image364.png" style="width: 5.48in; height: 2.20in;" /></a></p>
<p>The following table and graphic is produced. Again, the “Blank” category
has been deselected since there are no missing values in our dataset.</p>
<p><a class="reference internal" href="_images/image2210.png"><img alt="image18" src="_images/image2210.png" style="width: 6.50000in; height: 2.45227in;" /></a></p>
<p>You can change the Chart Type to a more traditional 100% Stacked Bar
chart, which is similar to a mosaic plot.</p>
<p><a class="reference internal" href="_images/image238.png"><img alt="image19" src="_images/image238.png" style="width: 3.05643in; height: 3.52083in;" /></a></p>
<div class="admonition-task admonition">
<p class="first admonition-title">Task:</p>
<p class="last">Spend a few minutes to ‘clean up’ your 100% stacked bar
chart to make it look like the one below.</p>
</div>
<p><a class="reference internal" href="_images/image246.png"><img alt="image20" src="_images/image246.png" style="width: 3.46098in; height: 2.60417in;" /></a></p>
<p>Pivot tables can be used for as many variables as you’d like. However,
you can easily become overwhelmed with too much information.</p>
<p><a class="reference internal" href="_images/image255.png"><img alt="image21" src="_images/image255.png" style="width: 6.50000in; height: 3.74628in;" /></a></p>
</div>
<div class="section" id="pivot-tables-with-numerical-data">
<h2>1.10.5. Pivot Tables with Numerical Data<a class="headerlink" href="#pivot-tables-with-numerical-data" title="Permalink to this headline">¶</a></h2>
<p>Next, open the <strong>NC_Birth.xlsx</strong> dataset. Suppose interest lies in the
relationship between Mother Minority status and the age of a Mother at
the time of birth. For example, do the data indicate that Nonwhite
mothers tend to be of a younger age?</p>
<p>To investigate this, start by creating a pivot table with the following
arguments.</p>
<p><a class="reference internal" href="_images/image265.png"><img alt="image22" src="_images/image265.png" style="width: 2.53125in; height: 2.17708in;" /></a></p>
<p>Next, change the Value Field Settings on <em>Mother Age</em> so that Excel
calculates the average age for each group.</p>
<p><a class="reference internal" href="_images/image275.png"><img alt="image23" src="_images/image275.png" style="width: 2.69792in; height: 2.44642in;" /></a></p>
<p>The results are shown below.</p>
<p><a class="reference internal" href="_images/image285.png"><img alt="image24" src="_images/image285.png" style="width: 2.89583in; height: 0.91667in;" /></a></p>
</div>
<div class="section" id="filtering-with-pivot-tables">
<h2>1.10.6. Filtering with Pivot Tables<a class="headerlink" href="#filtering-with-pivot-tables" title="Permalink to this headline">¶</a></h2>
<p>Consider the previous example. Suppose you also wanted to consider a
third variable, <em>Marital Status.</em> You can add marital status to the
Report Filter box:</p>
<p><a class="reference internal" href="_images/image294.png"><img alt="image25" src="_images/image294.png" style="width: 2.06081in; height: 1.90625in;" /></a></p>
<p>Now, you can click the drop-down arrow next to <em>Marital Status</em> in
order to filter the results based on this variable.</p>
<p><strong>For All:</strong>
<a class="reference internal" href="_images/image304.png"><img alt="image26" src="_images/image304.png" style="width: 3.18750in; height: 1.26042in;" /></a></p>
<p><strong>For only the Married women:</strong>
<a class="reference internal" href="_images/image3111.png"><img alt="image27" src="_images/image3111.png" style="width: 3.23958in; height: 1.30208in;" /></a></p>
<p><strong>For only the Unmarried women:</strong>
<a class="reference internal" href="_images/image326.png"><img alt="image28" src="_images/image326.png" style="width: 3.21875in; height: 1.31250in;" /></a></p>
<div class="admonition-tasks admonition">
<p class="first admonition-title">Tasks:</p>
<ol class="arabic">
<li><p class="first">Create the following PivotTable in Excel.</p>
</li>
<li><p class="first">Create the table shown below using the output from your PivotTable.</p>
<blockquote>
<div><p>Hints/functions used to create the table</p>
</div></blockquote>
</li>
</ol>
<ul class="last simple">
<li><code class="docutils literal"><span class="pre">Round()</span></code></li>
<li><code class="docutils literal"><span class="pre">Concatenate()</span></code></li>
<li><code class="docutils literal"><span class="pre">ISNUMBER()</span></code></li>
<li><code class="docutils literal"><span class="pre">IF()</span></code></li>
</ul>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="_images/image333.png"><img alt="image29" src="_images/image333.png" style="width: 3.33031in; height: 4.40625in;" /></a></td>
<td><a class="reference internal" href="_images/image343.png"><img alt="image30" src="_images/image343.png" style="width: 2.49967in; height: 4.60417in;" /></a></td>
</tr>
</tbody>
</table>
</div>
</div>


  
      
  <li id="relations-prev" class="navLink" title='Previous Section - 1.9. Excel: Basic String Functions' data-toggle="tooltip">
    <a href="h3.html" >
      <i class='prevNav glyphicon glyphicon-chevron-left'></i>
    </a>
  </li>
  <a class="navLinkBg" id="navLinkBgLeft"  href="h3.html" ></a>
  
  <li id="relations-next" class="navLink" title='Next Section - 1.11. Excel: Append, i.e. OFFSET() Function' data-toggle="tooltip" >
    <a href="h5.html" >
      <i id="relationsNextIcon" class='nextNav glyphicon glyphicon-chevron-right'></i>
    </a>
  </li>
  <a class="navLinkBg navLink" id="navLinkBgRight" href="h5.html" >Next Section - 1.11. Excel: Append, i.e. OFFSET() Function</a>

<script type="text/javascript">

  $('#relations-prev').tooltip({'placement':'right', 'selector': '', 'delay': { show: 100, hide: 50}});
  $('#relations-next').tooltip({'placement':'left', 'selector': '', 'delay': { show: 100, hide: 50}});
  
</script>
  
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      
      | <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2015 Todd Iverson.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.4.5.
    </p>
  </div>
</footer>



<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-32029811-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



  </body>
</html>